language: java
addons:
  sonarqube: true
jdk:
  - oraclejdk8
before_install:
  - if [ ! -z "$GPG_SECRET_KEYS" ]; then echo $GPG_SECRET_KEYS | base64 --decode | $GPG_EXECUTABLE --import; fi
  - if [ ! -z "$GPG_OWNERTRUST" ]; then echo $GPG_OWNERTRUST | base64 --decode | $GPG_EXECUTABLE --import-ownertrust; fi
install:
  - mvn clean --settings .travis/settings.xml install -DskipTests=true -Dmaven.javadoc.skip=true -Dgpg.skip -B -V
script:
  - mvn --settings .travis/settings.xml org.jacoco:jacoco-maven-plugin:prepare-agent sonar:sonar -Dsonar.login=$SONAR_TOKEN
deploy:
  - provider: script
    script: ".travis/deploy.sh"
    skip_cleanup: true
    on:
      repo: sbtqa/page-factory
      branch: master
      jdk: oraclejdk8
  - provider: script
    script: ".travis/deploy.sh"
    skip_cleanup: true
    on:
      repo: sbtqa/page-factory
      tags: true
      jdk: oraclejdk8
notifications:
  email: false
  slack:
    rooms:
      - secure: C+2Jd4jbn7HM17xmfDhmUcRUqv5+CnmlJksC7+iht8OqVMpKqotWLtTsfIKtsTA1DP4Af3Z/JedzC0+xl4Zy0rpZNMslp2MGZIcrsJ4aGXI4Yaw+u8iMKDpnjVX9myl6TFsPwNVjY+n48pLgPdgYGcpnyILblAHYvvYSpR9fttimiAP0uEwaDmbux3ImY/uUR8dkT3RtjMtEegZ9q43zmDB36wo1xUYC5wDjvQ4jjarQYfgvWmOP7+ViOX2T/BS0+IQh4eP0bD8bRtjlZHajiLSYJmXmv0/FWjaN9zSVQZ/vTb7bM1zHRr36zv1K0gU3WgVQNcu8hLXYEQW3LnuNWbV4usJ88MnyzoF3T+tRyPlyCoIqatEl6xoJF45Z6/hm7mgWnjTRS/7milMzrNJW8A2AL1MbS2wkaY/JygVEszw4JliGESuU7wlQQkL9t5/DKAb0OOr0NG3nCWKhgYn987lJJuMEHYIi4A3+I8/r2SOMdmKVMjKWV6BYX848SgweZ804vIxTBnDaFF+5dkihIC2YNLm47Sz/iJLd7wbcb+vHIa0OyrRyWyNnIGsyd3qDtChUEPuil6+R1yCOY4Avs4Yjm91b1i0oBNHGA1ijfnVycqbTjs4I8RAhH8AloGTxYm1aaKesoR15WyxddLleBtXTXhY1Ow2ORmaE1BBnjRk=
    template:
      - "Build status: %{message}"
      - "%{repository}#%{build_number} (%{branch} - %{commit} : %{author}): %{commit_message}"
      - "Change view : %{compare_url}"
      - "Build details : %{build_url}"